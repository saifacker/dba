CREATE TABLE EMPLOYEE(
SSN VARCHAR(10) PRIMARY KEY,
FNAME VARCHAR(15),
LNAME VARCHAR(15),
ADDRESS VARCHAR(15),
GENDER CHAR(1),
SALARY INTEGER,
SUPERSSN VARCHAR(10),
DNO INTEGER
);
 
INSERT INTO EMPLOYEE VALUES(111111,'RAJ','KUMAR','BENGALURU','M',700000,' ',1);
INSERT INTO EMPLOYEE VALUES(222222,'RASHMI','KUMARI','MYSORE','F',400000,111111,2);
INSERT INTO EMPLOYEE VALUES(333333,'RAGAVI','KUMARI','TUMKUR','F',800000,'',3);
INSERT INTO EMPLOYEE VALUES(444444,'RAJESH','KUMAR','TUMKUR','M',650000,333333,3);
INSERT INTO EMPLOYEE VALUES(555555,'RAVEESH','KUMAR','BENGALURU','M',500000,333333,3);
INSERT INTO EMPLOYEE VALUES(666666,'SCOTT','LANG','ENGLAND','M',700000,444444,5);
INSERT INTO EMPLOYEE VALUES(777777,'NIGANTH','KUMAR','GUBBI','M',200000,222222,2);
INSERT INTO EMPLOYEE VALUES(888888,'RAMYA','KUMARI','GUBBI','F',400000,222222,3);
INSERT INTO EMPLOYEE VALUES(999999,'VIDYA','KUMARI','TUMKUR','F',650000,333333,3);
INSERT INTO EMPLOYEE VALUES(100000,'GEETHA','KUMARI','TUMKUR','F',800000,'',3);

CREATE TABLE DEPARTMENT(
DNO INTEGER PRIMARY KEY,
DNAME VARCHAR(15),
MGRSSN VARCHAR(10),
MGRSTARTDATE DATE,
FOREIGN KEY(MGRSSN) references EMPLOYEE(SSN) ON DELETE CASCADE
);

SET FOREIGN_KEY_CHECKS=1;

INSERT INTO DEPARTMENT VALUES(1,'RESEARCH',111111,'12-08-10');
INSERT INTO DEPARTMENT VALUES(2,'ACCOUNTS',222222,'10-08-10');
INSERT INTO DEPARTMENT VALUES(3,'AI',333333,'12-04-15');
INSERT INTO DEPARTMENT VALUES(4,'NETWORKS',111111,'14-05-18');
INSERT INTO DEPARTMENT VALUES(5,'BIGDATA',666666,'10-01-21');

CREATE TABLE DLOCATION(
DNO INTEGER,
DLOC VARCHAR(15),
FOREIGN KEY(DNO) references DEPARTMENT(DNO) ON DELETE CASCADE
);

INSERT INTO DLOCATION VALUES(1,'MYSORE');
INSERT INTO DLOCATION VALUES(1,'TUMKUR');
INSERT INTO DLOCATION VALUES(1,'BENGALURU');
INSERT INTO DLOCATION VALUES(1,'GUBBI');
INSERT INTO DLOCATION VALUES(1,'DELHI');
INSERT INTO DLOCATION VALUES(1,'BENGALURU');

CREATE TABLE PROJECT(
PNO INTEGER PRIMARY KEY,
PNAME VARCHAR(15),
PLOCATION VARCHAR(15),
DNO INTEGER,
FOREIGN KEY(DNO) references DEPARTMENT(DNO) ON DELETE CASCADE
);

INSERT INTO PROJECT VALUES(111,'IOT','GUBBI',3);
INSERT INTO PROJECT VALUES(222,'TEXTSPEECH','GUBBI',3);
INSERT INTO PROJECT VALUES(333,'IPSECURITY','DELHI',4);
INSERT INTO PROJECT VALUES(444,'TRAFICCANAL','BENGALURU',5);
INSERT INTO PROJECT VALUES(555,'CLOUDSEC','DELHI',1);

CREATE TABLE WORKS_ON(
SSN VARCHAR(10),
PNO INTEGER,
HOURS INTEGER,
FOREIGN KEY(SSN) references EMPLOYEE(SSN) ON DELETE CASCADE,
FOREIGN KEY(PNO) references PROJECT(PNO) ON DELETE CASCADE
);

INSERT INTO WORKS_ON VALUES(666666,333,4);
INSERT INTO WORKS_ON VALUES(666666,111,2);
INSERT INTO WORKS_ON VALUES(111111,222,3);
INSERT INTO WORKS_ON VALUES(555555,222,2);
INSERT INTO WORKS_ON VALUES(333333,111,4);
INSERT INTO WORKS_ON VALUES(444444,111,6);
INSERT INTO WORKS_ON VALUES(222222,111,2);


-- QUERY 1
(SELECT DISTINCT PNO
FROM PROJECT P,DEPARTMENT D,EMPLOYEE E
WHERE P.DNO=D.DNO AND SSN=MGRSSN AND FNAME='SCOTT')
UNION
(
SELECT DISTINCT P.PNO
FROM PROJECT P,WORKS_ON W,EMPLOYEE E
WHERE P.PNO=W.PNO AND W.SSN=E.SSN AND FNAME='SCOTT'
);

-- QUERY 2
SELECT FNAME,LNAME,1.1*SALARY AS INCR_SAL
FROM EMPLOYEE E,WORKS_ON W,PROJECT P
WHERE E.SSN=W.SSN AND W.PNO=P.PNO AND P.PNAME='IOT';

-- QUERY 3
SELECT SUM(SALARY),AVG(SALARY),MAX(SALARY),MIN(SALARY)
FROM DEPARTMENT D,EMPLOYEE E
WHERE D.DNO=E.DNO AND D.DNAME='ACCOUNTS';

-- QUERY 4
SELECT FNAME
FROM EMPLOYEE E
WHERE NOT EXISTS ((SELECT PNO
FROM PROJECT
WHERE DNO=3 AND PNO NOT IN (
SELECT PNO
FROM WORKS_ON W,EMPLOYEE E
WHERE E.SSN=W.SSN)
));

-- QUERY 5
SELECT DNO,COUNT(SSN)
FROM EMPLOYEE 
WHERE SALARY>600000 AND DNO IN(SELECT DNO
								FROM EMPLOYEE
                                GROUP BY DNO
                                HAVING COUNT(SSN)>5)
GROUP BY DNO;

CREATE TABLE PUBLISHER(NAME VARCHAR(20) PRIMARY KEY,ADDRESS VARCHAR(20),PHONE INT);
CREATE TABLE BOOK(BOOK_ID INT PRIMARY KEY,TITLE VARCHAR(20),PUBLISHER_NAME VARCHAR(20),PUB_YEAR VARCHAR(20));
CREATE TABLE BOOK_AUTHOR(BOOK_ID INT REFERENCES BOOK(BOOK_ID),AUTHOR_NAME VARCHAR(20));
CREATE TABLE LIBRARY_BRANCH(BRANCH_ID INT PRIMARY KEY,BRANCH_NAME VARCHAR(20),ADDRESS VARCHAR(20));
CREATE TABLE BOOK_COPIES(BOOK_ID INT REFERENCES BOOK(BOOK_ID),BRANCH_ID INT REFERENCES LIBRARY_BRANCH(BRANCH_ID),NO_OF_COPIES INT);
CREATE TABLE BOOK_LENDING(BOOK_ID INT REFERENCES BOOK(BOOK_ID),BRANCH_ID INT REFERENCES LIBRARY_BRANCH(BRANCH_ID),CARD_NO INT,DATE_OUT VARCHAR(20),DUE_DATE VARCHAR(20));

INSERT INTO PUBLISHER VALUES('PEARSON','BANGALORE',984514187);
INSERT INTO PUBLISHER VALUES('MCGRAW','NEWDELHI',984536187);
INSERT INTO PUBLISHER VALUES('SAPNA','BANGALORE',984512181);

INSERT INTO BOOK VALUES(1111,'SE','PEARSON',2005);
INSERT INTO BOOK VALUES(2222,'DBMS','MCGRAW',2004);
INSERT INTO BOOK VALUES(3333,'ANOTOMY','PEARSON',2010);
INSERT INTO BOOK VALUES(4444,'ME','SAPNA',2010);

INSERT INTO BOOK_AUTHOR VALUES(1111,'SOMMERVILLE');
INSERT INTO BOOK_AUTHOR VALUES(2222,'NAVATHE');
INSERT INTO BOOK_AUTHOR VALUES(3333,'HENRY GRAY');
INSERT INTO BOOK_AUTHOR VALUES(4444,'THOMAS');

INSERT INTO LIBRARY_BRANCH VALUES(11,'CENTRAL TECHNICAL','MG ROAD');
INSERT INTO LIBRARY_BRANCH VALUES(22,'MEDICAL','BH ROAD');
INSERT INTO LIBRARY_BRANCH VALUES(33,'CHILDREN','SS ROAD');
INSERT INTO LIBRARY_BRANCH VALUES(44,'SECRETARIAT','MH ROAD');
INSERT INTO LIBRARY_BRANCH VALUES(55,'GENERAL','MSL ROAD');

INSERT INTO BOOK_COPIES VALUES (1111,11,5);
INSERT INTO BOOK_COPIES VALUES (3333,22,6);
INSERT INTO BOOK_COPIES VALUES (4444,33,10);
INSERT INTO BOOK_COPIES VALUES (2222,11,12);
INSERT INTO BOOK_COPIES VALUES (4444,55,3);

INSERT INTO BOOK_LENDING VALUES(2222,11,1,'10-JAN-2017','20-AUG-2017');
INSERT INTO BOOK_LENDING VALUES(3333,22,2,'09-JUL-2017','12-AUG-2017');
INSERT INTO BOOK_LENDING VALUES(4444,55,1,'11-APR-2017','09-AUG-2017');
INSERT INTO BOOK_LENDING VALUES(2222,11,5,'09-AUG-2017','19-AUG-2017');
INSERT INTO BOOK_LENDING VALUES(4444,33,1,'10-JUN-2017','15-AUG-2017');
INSERT INTO BOOK_LENDING VALUES(1111,11,1,'12-MAY-2017','10-JUN-2017');
INSERT INTO BOOK_LENDING VALUES(3333,22,1,'10-JUL-2017','15-JUL-2017');
SELECT * FROM BOOK;

SELECT * FROM BOOK_AUTHOR;

SELECT * FROM PUBLISHER;

SELECT * FROM BOOK_COPIES;

SELECT * FROM BOOK_LENDING;

SELECT * FROM LIBRARY_BRANCH;

SELECT lb.BRANCH_NAME, b.BOOK_ID, b.TITLE,PUBLISHER_NAME,
ba.AUTHOR_NAME, bc.NO_OF_COPIES,lb.BRANCH_ID
FROM BOOK b,BOOK_AUTHOR ba,BOOK_COPIES bc,LIBRARY_BRANCH lb
WHERE b.BOOK_ID=ba.BOOK_ID AND ba.BOOK_ID=bc.BOOK_ID 
AND bc.BRANCH_ID=lb.BRANCH_ID;

SELECT CARD_NO
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '01-JAN-2017' AND '30-JUN-2017'
group by CARD_NO
having count(*) > 3;

delete from book
where book_id='3333';
SELECT * FROM BOOK;

SELECT BOOK_ID,TITLE,PUBLISHER_NAME,PUB_YEAR
FROM BOOK
GROUP BY PUB_YEAR,BOOK_ID,TITLE,PUBLISHER_NAME;

CREATE VIEW BOOK_AVAILABLE AS
SELECT B.BOOK_ID,B.TITLE,C.NO_OF_COPIES
FROM LIBRARY_BRANCH L,BOOK B,BOOK_COPIES c
WHERE B.BOOK_ID =C.BOOK_ID AND L.BRANCH_ID=C.BRANCH_ID;

SELECT * FROM BOOK_AVAILABLE;